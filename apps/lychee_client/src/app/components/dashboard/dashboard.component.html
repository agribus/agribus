<h2>Latest Measures</h2>

<div class="latest-measures-container">
  <div class="weather-container">
    @for (metric of metrics; track metric.id) {
      <div class="card" tuiAppearance="neutral" tuiCardMedium [tuiHint]="tooltipMetrics">
        <tui-icon [icon]="getIcon(metric.type)" />
        <h2 tuiTitle>{{ metric.label }}</h2>
        <span class="data-text">{{ metric.value }} {{ getUnit(metric.type) }}</span>
        <span tuiSubtitle class="latest-update">Last update: {{ metric.last_update }}</span>
      </div>

      <ng-template #tooltipMetrics>
        <span>Last update: {{ metric.last_update }}</span>
      </ng-template>
    }
  </div>

  <div class="sensor-container">
    @for (sensor of sensors; track sensor.id) {
      <div class="card" tuiAppearance="neutral" tuiCardMedium [tuiHint]="tooltipSensors">
        <h2 tuiTitle>{{ sensor.name }}</h2>
        <span tuiSubtitle class="latest-update">Last update: {{ sensor.last_update }}</span>
        <div class="sensor-metrics">
          <span class="data-text">{{ sensor.temperature }} {{ getUnit("temperature") }}</span>
          <span class="data-text">{{ sensor.humidity }} {{ getUnit("humidity") }}</span>
          <span class="data-text">{{ sensor.air_pressure }} {{ getUnit("air_pressure") }}</span>
        </div>
      </div>

      <ng-template #tooltipSensors>
        <span>Last update: {{ sensor.last_update }}</span>
      </ng-template>
    }
  </div>

  <h2>Latest Alerts</h2>

  <div class="alerts-container">
    @for (alert of alerts; track alert.id) {
      <div class="card" tuiAppearance="neutral" tuiCardMedium>
        <tui-badge [appearance]="badgeAppearance[alert.type]" tuiStatus>
          {{ badgeLabel[alert.type] }}
        </tui-badge>

        <h2 tuiTitle>
          {{ alert.title }}
          <span tuiSubtitle class="latest-update">{{ alert.last_update }}</span>
          @if (alert.description) {
            <span tuiSubtitle class="informative-alert">{{ alert.description }}</span>
          }
        </h2>
      </div>
    }
  </div>

  <h2>Charts</h2>
  <div class="charts-container">
    <button
      class="calendar-button"
      appearance="secondary"
      iconStart="@tui.calendar"
      tuiIconButton
      type="button"
      (click)="onClick()"></button>
    <span>{{ date$ | async }}</span>

    <app-chart-dashboard
      title="Temperature"
      [data]="tempData"
      [range]="selectedRange"
      unit="Â°C"
      [yMin]="0"
      [yMax]="50"></app-chart-dashboard>

    <app-chart-dashboard
      title="Humidity"
      [data]="humidityData"
      [range]="selectedRange"
      unit="%"
      [yMin]="0"
      [yMax]="100"></app-chart-dashboard>

    <app-chart-dashboard
      title="Air pressure"
      [data]="pressureData"
      [range]="selectedRange"
      unit="hPa"
      [yMin]="950"
      [yMax]="1050"></app-chart-dashboard>
  </div>
</div>
